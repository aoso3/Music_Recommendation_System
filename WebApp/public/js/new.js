(function(e){e.fn.hap=function(c){function g(a){var b,f="https:"==window.location.protocol?"https:":"http:";if(!window.FB&&a&&!document.body.querySelector("#fb-root"))return b=document.createElement("script"),b.text="window.fbAsyncInit=function(){FB.init({appId:'"+a+"',status:true,xfbml:true})};(function(e,t,n){var r,i=e.getElementsByTagName(t)[0];if(e.getElementById(n)){return}r=e.createElement(t);r.id=n;r.src='"+f+"//connect.facebook.net/en_US/all.js';i.parentNode.insertBefore(r,i)})(document,'script','facebook-jssdk')",
a=document.createElement("div"),a.id="fb-root",document.body.appendChild(a),document.body.appendChild(b)}function G(a){p.mediaId&&"file:"!=window.location.protocol&&e.ajax({url:Ha+"includes/statistics.php",type:"post",data:[{name:"action",value:a},{name:"media_id",value:p.mediaId}],dataType:"json"}).done(function(a){a.play_count&&HAPUtils.isNumber(a.play_count)&&ob.find("span").html(HAPUtils.nFormatter(a.play_count,1));a.like_count&&HAPUtils.isNumber(a.like_count)&&Wa.find("span").html(HAPUtils.nFormatter(a.like_count,
1));a.download_count&&HAPUtils.isNumber(a.download_count)&&ua.find("span").html(HAPUtils.nFormatter(a.download_count,1))}).fail(function(a,f,t){console.log("Error getStats: "+a,f,t)})}function y(a){if(h){if(!va){if("touchstart"==a.type){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault();va=!0;U.on(ca,function(a){a:{var b;if("touchmove"==a.type){if(a.originalEvent.touches&&a.originalEvent.touches.length)b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=
a.originalEvent.changedTouches;else break a;if(1<b.length)break a;b=b[0]}else b=a;a.preventDefault();z(b)}}).on(da,function(a){a:if(va){va=!1;U.off(ca).off(da);var b;if("touchend"==a.type){if(a.originalEvent.touches&&a.originalEvent.touches.length)b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else break a;if(1<b.length)break a;b=b[0]}else b=a;a.preventDefault();z(b)}})}return!1}}function z(a){a=a.pageX-Ia.offset().left;
0>a?a=0:a>R&&(a=R);a=Math.max(0,Math.min(1,a/R));if(d&&ja)try{d.currentTime=a*d.duration}catch(b){console.log(b)}}function q(){ja&&(ka.off("mousemove",A).off("mouseout",q),U.off("mouseout",q),H.hide())}function A(a){var b=a.pageX-Ia.offset().left;if(!HAPUtils.isNumber(b))return!1;0>b?b=0:b>R&&(b=R);var f=n[0].getBoundingClientRect(),t=ka[0].getBoundingClientRect();a=parseInt(a.pageX-f.left-H.outerWidth()/2);f=parseInt(t.top-f.top-5-H.outerHeight(),10);H.css({left:a+"px",top:f+"px"}).show();f=Math.max(0,
Math.min(1,b/R));if(!HAPUtils.isNumber(f))return!1;d&&(b=d.duration,f*=b,HAPUtils.isNumber(f)&&HAPUtils.isNumber(b)&&H.find("p").html(HAPUtils.formatCurrentTime(f)+" / "+HAPUtils.formatDuration(b)))}function wa(a){if(h){if(!xa){if("touchstart"==a.type){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault();xa=!0;U.on(ca,function(a){a:{var b;if("touchmove"==a.type){if(a.originalEvent.touches&&a.originalEvent.touches.length)b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&
a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else break a;if(1<b.length)break a;b=b[0]}else b=a;a.preventDefault();ya(b)}}).on(da,function(a){a:if(xa){xa=!1;U.off(ca).off(da);var b;if("touchend"==a.type){if(a.originalEvent.touches&&a.originalEvent.touches.length)b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else break a;if(1<b.length)break a;b=b[0]}else b=a;a.preventDefault();ya(b)}})}return!1}}
function k(){if(!h)return!1;0<w?(Xa=w,w=0):w=Xa;V()}function ya(a){la?(w=Math.max(0,Math.min(1,(a.pageY-ma.offset().top)/na)),w=1-w):w=Math.max(0,Math.min(1,(a.pageX-ma.offset().left)/na));V()}function V(a){"undefined"!==typeof a&&(w=a);d&&(d.volume=w);Vb.css(la?"height":"width",w*na+"px");0==w?pb.find("i").removeClass("fa-volume-up fa-volume-down").addClass("fa-volume-off"):pb.find("i").removeClass("fa-volume-off fa-volume-down").addClass("fa-volume-up")}function S(){W.off("mousemove",C).off("mouseout",
S);U.off("mouseout",S);H.hide()}function C(a){var b=la?a.pageY-ma.offset().top:a.pageX-ma.offset().left;0>b?b=0:b>na&&(b=na);b=Math.max(0,Math.min(1,b/na));la&&(b=1-b);b=parseInt(100*b,10);H.find("p").text(b+" %");var b=n[0].getBoundingClientRect(),f=W[0].getBoundingClientRect();if(la)var f=parseInt(f.left-b.left-H.outerWidth()/2+W.outerWidth()/2),t=parseInt(a.pageY-b.top-H.outerHeight()-10);else t=parseInt(f.top-b.top-H.outerHeight()),f=parseInt(a.pageX-b.left-H.outerWidth()/2);H.css({left:f+"px",
top:t+"px"}).show()}function ea(a){a.preventDefault();if(!h)return!1;a=e(a.currentTarget).attr("data-id");if(a==l.getCounter())return!1;Ya=!0;l.processPlaylistRequest(a);e(m).trigger("clickPlaylistItem",{instance:m,instanceName:I,counter:a})}function M(a){a.preventDefault();if(!h)return!1;a=e(a.currentTarget);if(a.attr("data-id")==l.getCounter())return!1;a.removeClass("playlist-non-selected").addClass("playlist-selected")}function qb(a){a.preventDefault();if(!h)return!1;a=e(a.currentTarget);if(a.attr("data-id")==
l.getCounter())return!1;a.removeClass("playlist-selected").addClass("playlist-non-selected")}function Wb(a){if(!h)return!1;a=e(a.currentTarget);if(a.hasClass("prev-toggle"))m.previousMedia();else if(a.hasClass("playback-toggle"))m.togglePlayback();else if(a.hasClass("next-toggle"))m.nextMedia();else if(a.hasClass("loop-toggle"))N=!N,l.setLooping(N),N?oa.find("i").removeClass("icon-color").addClass("icon-rollover-color"):oa.find("i").removeClass("icon-rollover-color").addClass("icon-color");else if(a.hasClass("random-toggle"))O=
!O,l.setRandom(O),O?pa.find("i").removeClass("icon-color").addClass("icon-rollover-color"):pa.find("i").removeClass("icon-rollover-color").addClass("icon-color");else if(a.hasClass("sort-alpha"))m.sort("title",Ja),(Ja=!Ja)?a.find("i").removeClass("fa-sort-alpha-desc").addClass("fa-sort-alpha-asc"):a.find("i").removeClass("fa-sort-alpha-asc").addClass("fa-sort-alpha-desc");else if(a.hasClass("popup-toggle"))openPopup(m,c);else if(a.hasClass("share-item")&&p.share)a:{a=a.attr("data-share").toLowerCase();
var b="https:"==window.location.protocol?"https:":"http:",f=(window.screen.width-600)/2,t=(window.screen.height-300)/2,J=m.getTitle(l.getCounter()),Xb=p.description||"",g=p.thumb?HAPUtils.qualifyURL(p.thumb):"",za=p.share,d;if("facebook"==a){if(d=b+"//www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(za),window.FB){window.FB&&FB.ui({method:"feed",name:document.title,link:za,picture:g,caption:J});break a}}else"twitter"==a?d=b+"//twitter.com/share?url="+encodeURIComponent(za)+"&text="+encodeURIComponent(J):
"googleplus"==a?d=b+"//plus.google.com/share?url="+encodeURIComponent(za):"tumblr"==a&&(d=b+"//www.tumblr.com/share/link?url="+encodeURIComponent(za)+"&amp;name="+encodeURIComponent(J)+"&amp;description="+encodeURIComponent(Xb));d&&window.open(d,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width=600,height=300,left="+f+",top="+t+"")}}function Yb(a){if(!h||xa||va)return!1;a=e(a.currentTarget).find("i");a.hasClass("icon-color")&&a.removeClass("icon-color").addClass("icon-rollover-color")}
function Zb(a){if(!h)return!1;a=e(a.currentTarget);var b=a.find("i");a.hasClass("random-toggle")&&O||a.hasClass("loop-toggle")&&N||b.hasClass("icon-rollover-color")&&b.removeClass("icon-rollover-color").addClass("icon-color")}function Za(){if(-1<P){var a=x.children("div.playlist-item[data-id="+P+"]"),b=a.find(".playlist-non-selected, .playlist-selected");a.length&&(a.attr("data-id"),b.removeClass("playlist-selected").addClass("playlist-non-selected"));e(m).trigger("playlistItemEnabled",{instance:m,
instanceName:I,item:a})}}function $a(a){Q=!0;Ka.show();K&&ab();var b=rb.find("#"+a);if(0==b.length){if(Aa){localStorage.removeItem(Ba);fa=null;HAPUtils.isEmpty(c.activePlaylist)||$a(c.activePlaylist);return}alert('Failed to select playlist! Check activePlaylist option in settings. Make sure that element: "'+a+'" exist in playlist-list!');Ka.hide();return Q=!1}e(m).trigger("playlistStartLoad",{instance:m,instanceName:I});var f,t;b.find(".playlist-item").each(function(){t=e(this);f=bb(t);B.push(f)});
r=B.length;u()}function bb(a){var b={};b.origclasses=a.attr("class");b.type=a.attr("data-type");void 0==a.attr("data-media-id")||HAPUtils.isEmpty(a.attr("data-media-id"))||(b.mediaId=parseInt(a.attr("data-media-id"),10));"audio"==b.type?b.mp3=a.attr("data-mp3"):void 0==a.attr("data-path")||HAPUtils.isEmpty(a.attr("data-path"))||(b.path=b.id=a.attr("data-path"));HAPUtils.isEmpty(a.html())||(b.content=a.html());void 0!=a.attr("data-limit")&&!HAPUtils.isEmpty(a.attr("data-limit"))&&HAPUtils.isNumber(a.attr("data-limit"))&&
0!=Math.abs(parseInt(a.attr("data-limit"),10))&&(b.limit=Math.abs(parseInt(a.attr("data-limit"),10)));void 0==a.attr("data-artwork")||HAPUtils.isEmpty(a.attr("data-artwork"))||(b.artwork=a.data("artwork"));void 0==a.attr("data-thumb")||HAPUtils.isEmpty(a.attr("data-thumb"))?void 0==a.attr("data-thumb-default")||HAPUtils.isEmpty(a.attr("data-thumb-default"))||(b.thumbDefault=a.attr("data-thumb-default")):b.thumb=a.attr("data-thumb");void 0==a.attr("data-thumb-quality")||HAPUtils.isEmpty(a.attr("data-thumb-quality"))||
(b.thumbQuality=a.attr("data-thumb-quality"));void 0==a.attr("data-title")||HAPUtils.isEmpty(a.attr("data-title"))||(b.title=a.attr("data-title"));void 0==a.attr("data-description")||HAPUtils.isEmpty(a.attr("data-description"))||(b.description=a.attr("data-description"));void 0==a.attr("data-artist")||HAPUtils.isEmpty(a.attr("data-artist"))||(b.artist=a.attr("data-artist"));void 0==a.attr("data-album")||HAPUtils.isEmpty(a.attr("data-album"))||(b.album=a.attr("data-album"));void 0!=a.attr("data-download")&&
(b.download=a.attr("data-download"));void 0!=a.attr("data-id3")&&(b.id3=!0);void 0==a.attr("data-start")||HAPUtils.isEmpty(a.attr("data-start"))||(b.start=Math.abs(a.attr("data-start")));void 0==a.attr("data-end")||HAPUtils.isEmpty(a.attr("data-end"))||(b.end=Math.abs(a.attr("data-end")));void 0==a.attr("data-duration")||HAPUtils.isEmpty(a.attr("data-duration"))||(b.duration=Math.abs(a.attr("data-duration")));void 0!=a.attr("data-playback-rate")&&(b.playbackRate=1,HAPUtils.isEmpty(a.attr("data-playback-rate"))||
(b.playbackRate=Math.abs(a.attr("data-playback-rate"))));void 0==a.attr("data-link")||HAPUtils.isEmpty(a.attr("data-link"))||(b.link=a.attr("data-link"),b.target="_blank",void 0==a.attr("data-target")||HAPUtils.isEmpty(a.attr("data-target"))||(b.target=a.attr("data-target")));void 0!=a.attr("data-share")&&(b.share=a.attr("data-share"));void 0==a.attr("data-table")||HAPUtils.isEmpty(a.attr("data-table"))||(b.table=a.attr("data-table"));void 0==a.attr("data-range")||HAPUtils.isEmpty(a.attr("data-range"))||
(a=a.attr("data-range").split(","),b.range=[Math.abs(parseInt(a[0],10)),Math.abs(parseInt(a[1]))]);return b}function u(){F++;if(F>r-1)$b();else{var a=B[F],b=B[F].type;/^audio$/.test(b)?(L.push(a),u()):/^soundcloud$/.test(b)?sb?tb():ac():/^podcast$/.test(b)?bc():/^folder$/.test(b)?cc(b):/^gdrive-folder$/.test(b)?dc():/^database$/.test(b)?ec(b):/^xml$/.test(b)?fc():(console.log("Wrong data-type in playlist! Type = "+b),u())}}function cc(){if("file:"==window.location.protocol)return alert("Reading files from folders locally is not possible! This requires online server connection."),
u(),!1;var a=B[F],b=a.path.replace(/\/\//g,"/"),f=Ha+"includes/folder_parser.php",b={dir:b};a.id3&&(ub=Ca=L.length-1);e.ajax({type:"GET",url:f,data:b,dataType:"json"}).done(function(b){HAPUtils.keysrt(b,"filename");var f,t=b.length,c,d,g,l=a.limit||1E4,h=0;for(f=0;f<t&&(c=b[f],!/.mp3/.test(c.basename)||(d=e.extend(!0,{},a),d.type="audio",g=c.fullpath,d.mp3=g,d.thumb||(d.thumb=g.substr(0,g.lastIndexOf("."))+".png"),"undefined"!==typeof d.download&&HAPUtils.isEmpty(d.download)&&(d.download=g),"undefined"!==
typeof d.share&&HAPUtils.isEmpty(d.share)&&(d.share=g),d.title||(d.title=c.filename),L.push(d),Ca++,h++,h!=l));f++);a.id3?cb():u()}).fail(function(a,b,f){console.log("Error processFolder: "+a,b,f);u()})}function dc(){if("file:"==window.location.protocol)return alert("Reading files from folders locally is not possible! This requires online server connection."),u(),!1;if(HAPUtils.isEmpty(vb))return alert("gDriveAppId has not been set in settings!"),u(),!1;var a=B[F];e.ajax({url:"https://www.googleapis.com/drive/v3/files?q='"+
a.path+"'+in+parents&key="+vb,dataType:"jsonp"}).done(function(b){var f,t=b.files.length,J,d=[],c=[];for(f=0;f<t;f++)J=b.files[f],/.mp3|mpeg|mpeg3/.test(J.mimeType)?(c.push(J),HAPUtils.keysrt(c,"name")):/.jpg|jpeg|png/.test(J.mimeType)&&(d.push(J),HAPUtils.keysrt(d,"name"));t=c.length;for(f=0;f<t;f++)J=c[f],b=e.extend(!0,{},a),b.type="audio",b.mp3="https://drive.google.com/uc?export=view&id="+J.id,"undefined"!==typeof b.download&&HAPUtils.isEmpty(b.download)&&(b.download="https://drive.google.com/uc?export=download&id="+
J.id),"undefined"!==typeof b.share&&HAPUtils.isEmpty(b.share)&&(b.share="https://drive.google.com/open?id="+J.id),d.length&&!b.thumb&&d[f]&&(b.thumb="https://drive.google.com/uc?export=view&id="+d[f].id),b.title||(b.title=J.name.substr(0,J.name.lastIndexOf("."))),L.push(b);u()}).fail(function(a,f,t){console.log("Error processGdriveFolder: "+a,f,t);u()})}function cb(){var a=L[Ca];jsmediatags.read(a.mp3,{onSuccess:function(b){var f=b.tags;b=f.picture;f.artist&&(a.artist=f.artist);f.title&&(a.title=
f.title);f.album&&(a.album=f.album);if(b){var f="",t,e=b.data.length;for(t=0;t<e;t++)f+=String.fromCharCode(b.data[t]);a.thumb="data:"+b.format+";base64,"+window.btoa(f)}Ca--;Ca>ub?cb():u()},onError:function(a){console.log("ID3 error: ",a.type,a.info);cb()}})}function fc(){var a=B[F],b=0,f=F;B.splice(f,1);e.ajax({type:"GET",url:a.path,dataType:"html"}).done(function(a){var t,d;e(a).children("li.playlist-item").each(function(){t=e(this);d=bb(t);B.splice(f,0,d);f++;b++});r+=b-1;--F;u()}).fail(function(a,
b,f){console.log("Error processXml: "+a,b,f);u()})}function bc(){if("file:"==window.location.protocol)alert("Using Podcast locally is not possible! This requires online server connection!"),u();else{var a=B[F],b=Ha+"includes/ba-simple-proxy.php?url="+encodeURIComponent(a.path);e.ajax({url:b,dataType:"json",cache:!1}).done(function(b){var f=HAPUtils.parseXML(b.contents),d,c,g,h=0,l=a.limit||1E3;e(f).find("image").length&&e(f).find("image").attr("href")?g=e(f).find("image").attr("href"):e(b.contents).find("itunes\\:image").length&&
e(b.contents).find("itunes\\:image").attr("href")&&(g=e(b.contents).find("itunes\\:image").attr("href"));e(f).find("item").each(function(){if(h>=l)return!1;d=e(this);c=e.extend(!0,{},B[F]);c.type="audio";c.mp3=d.find("enclosure").attr("url");"undefined"!==typeof c.download&&HAPUtils.isEmpty(c.download)&&(c.download=c.mp3);!c.title&&d.find("title").length&&(c.title=d.find("title").text());!c.artist&&d.find("author").length&&(c.artist=d.find("author").text());!c.description&&d.find("description").length&&
(c.description=d.find("description").text());!c.duration&&d.find("duration").length&&(c.duration=d.find("duration").text());c.thumb||(d.find("image").length&&d.find("image").attr("href")?c.thumb=d.find("image").attr("href"):g&&(c.thumb=g));"undefined"!==typeof c.share&&HAPUtils.isEmpty(c.share)&&d.find("link").length&&(c.share=d.find("link").text());L.push(c);h++});u()}).fail(function(a,b,c){console.log("Error processPodcast: "+a,b,c);u()})}}function ac(){if("file:"==window.location.protocol)alert("Using SoundCloud locally is not possible! This requires online server connection!"),
u();else{if(HAPUtils.isEmpty(db))return alert("soundCloudAppId has not been set! Skipping Soundcloud url: "+path),u(),!1;var a=document.createElement("script");a.src="https://connect.soundcloud.com/sdk.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b);var f=setInterval(function(){window.SC&&(f&&clearInterval(f),SC.initialize({client_id:db}),sb=!0,tb())},100)}}function tb(){var a=B[F],b=a.path;ga=a.limit||200;/\/favorites$/.test(b)&&(b=b.replace(/\/favorites$/,"/likes"));
SC.get("/resolve",{url:b},function(a,b){if(b&&b.message)return console.log(b.message),u(),!1;if(jQuery.isArray(a)){var f,c=a.length;c>ga&&(c=ga);for(f=0;f<c;f++)L.push(La(a[f],!0));u()}else if("playlist"==a.kind){c=a.tracks.length;c>ga&&(c=ga);for(f=0;f<c;f++)L.push(La(a.tracks[f],!0));u()}else"user"==a.kind?eb("/users/"+a.id+"/tracks"):"group"==a.kind?eb("/groups/"+a.id+"/tracks"):"track"==a.kind&&(L.push(La(a)),u())})}function eb(a){SC.get(a,{limit:200,linked_partitioning:1},function(a,f){var b,
c=a.collection.length,d;L.length+c>=ga&&(c=ga-L.length,d=!0);for(b=0;b<c;b++)L.push(La(a.collection[b]));a.next_href&&!d?eb(a.next_href):u()})}function La(a){if(a.streamable&&a.stream_url){var b=e.extend(!0,{},B[F]);b.type="audio";a.duration&&(b.duration=a.duration);b.mp3=a.stream_url+"?client_id="+db;"undefined"!==typeof b.download&&HAPUtils.isEmpty(b.download)&&a.downloadable&&a.download_url&&(b.download=b.mp3.replace(/\/stream\\?/,"/download"));!b.title&&a.title&&(b.title=a.title);!b.description&&
a.description&&(b.description=a.description);!b.thumb&&a.artwork_url&&(b.thumb=a.artwork_url,b.thumbQuality&&(b.thumb=b.thumb.replace("large.jpg",b.thumbQuality)));b.favoritingsCount=parseInt(a.favoritings_count?a.favoritings_count:0,10);b.playbackCount=parseInt(a.playback_count?a.playback_count:0,10);b.hotness=b.favoritingsCount+b.playbackCount;"undefined"!==typeof b.share&&HAPUtils.isEmpty(b.share)&&a.permalink_url&&(b.share=a.permalink_url);return b}}function ec(){if("file:"==window.location.protocol)return console.log("Reading database locally is not possible! This requires online server connection."),
u(),!1;var a=B[F],b=0,f=F,c=Ha+"includes/database.php";B.splice(f,1);var d=a.limit||null,g=null,h=null;void 0!=a.range&&(g=a.range[0],h=a.range[1]);e.ajax({type:"POST",url:c,data:{database:a.path,table:a.table,limit:d,range_from:g,range_to:h}}).done(function(a){if(-1<a.indexOf("Database information missing!")||-1<a.indexOf("Db connection failed")||-1<a.indexOf("Db selection failed")||-1<a.indexOf("Db query failed"))console.log("Error loading database!"+a);else{a=e.parseJSON(a);var c,d=a.length,g;
for(c=0;c<d;c++)g=a[c],g.type&&(g.mp3||g.path)&&(B.splice(f,0,g),f++,b++);r+=b-1;--F}u()}).fail(function(a,b,f){console.log("Error processDataBase: "+a,b,f);u()})}function $b(){var a,b,f=aa?D:v.length,c=L.length,d,g,h,k,G=0,p;for(b=0;b<c;b++){a=b+f;aa&&G++;k=L[b];d=k.type;if(qa){k.origclasses||(k.origclasses="playlist-item");g=e('<div class="'+k.origclasses+'"/>').attr({"data-type":d});delete k.origclasses;aa?(p?p.after(g):T?g.appendTo(x):x.children("div").eq(D).before(g),p=g):g.appendTo(x);h=e('<a class="playlist-non-selected" href="#"/>').appendTo(g);
if(-1!=e.inArray("thumb",wb)){var n=k.thumb||k.thumbDefault;if(n){var M=new Image;M.className="hidden";M.onload=function(){this.className="visible"};M.src=n;e('<span class="playlist-thumb"></span>').append(M).appendTo(h)}}-1!=e.inArray("title",wb)&&e('<span class="playlist-title"></span>').appendTo(h);gc&&k.link&&(n=e('<a class="link" href="'+k.link+'" target="'+k.target+'"><i class="fa fa-link"></i></a>'),h.after(n));hc&&ic&&k.download&&(n=e('<a class="download" href="'+k.download+'" download><i class="fa fa-download"></i></a>'),
h.after(n));k.content&&(g.append(k.content),delete k.content)}k.thumb&&!k.artwork&&(k.artwork=[{src:k.thumb}]);v.splice(a,0,{id:a,type:d,data:k})}qa&&xb();K=x;ra();aa||fb?(a=l.getCounter(),l.setPlaylistItems(r,!1),D<=a&&(T||l.reSetCounter(a+G)),X?(X=!1,Y&&!Z&&(ha=!0),l.setCounter(D,!1)):Y&&l.setCounter(D,!1),-1!=l.getCounter()&&(P=l.getCounter())):l.setPlaylistItems(r);Ma();Da=!0;e(m).trigger("playlistEndLoad",{instance:m,instanceName:I})}function xb(){x.children(".playlist-item").each(function(){var a=
e(this).find(".playlist-non-selected, .playlist-selected").on("click",ea);if(!Z)a.on("mouseenter",M).on("mouseleave",qb)});yb&&!gb&&(x.sortable({update:function(a,b){var f=jQuery(b.item).index();m.trackDropSort(null,null,f)}}),gb=!0)}function ra(){r=v.length;if(qa){var a=0,b,f,c,d;Na=[];x.find("div.playlist-item").each(function(){f=e(this).attr("data-id",a);c=f.find(".playlist-non-selected, .playlist-selected").attr("data-id",a);d=c.find(".playlist-title");d.length&&(b=m.getTitle(a),Na.push(b),v[a].data.title_full=
b,zb?d.html(HAPUtils.formatNumber(a)+Ab+b):d.html(b));v[a].id=a;a++});Oa&&Pa&&0<r&&"horizontal"==Qa&&sa.mCustomScrollbar("update")}}function Ma(){aa=fb=!1;Ka.hide();Q=!1;h||(h=!0,Oa&&!Pa&&(sa.mCustomScrollbar({axis:"horizontal"==Qa?"x":"y",theme:c.playlistScrollTheme,scrollInertia:0,mouseWheel:{normalizeDelta:!0,deltaFactor:50,preventDefault:!0},keyboard:{enable:!1},advanced:{autoExpandHorizontalScroll:!0}}),Pa=!0),setTimeout(function(){clearTimeout(this);Bb()},50),V(w),c.autoOpenPopup&&Cb.click(),
e(m).trigger("setupDone",{instance:m,instanceName:I}));if(!hb&&!aa&&0<r){var a=Aa&&fa?fa.activeItem:c.activeItem;a>r-1&&(a=r-1);-1<a&&l.setCounter(a,!1);hb=!0}}function Db(){Eb||(Ea=e(document.createElement("audio")).attr("preload",m.preload),d=Ea[0],Eb=!0);d.src=p.mp3||p.path;Ea.on("ended",function(){Fb()}).on("canplay",function(a){}).on("canplaythrough",function(a){}).on("loadedmetadata",function(){p.playbackRate&&(d.playbackRate=Number(p.playbackRate));p.resumeTime?(d.currentTime=p.resumeTime,
delete p.resumeTime):p.start&&(d.currentTime=p.start)}).on("play",function(){ja||(ja=!0,ib&&G("hap_play_count"),ta&&cancelAnimationFrame(ta),ta=requestAnimationFrame(Gb),e(m).trigger("soundStart",{instance:m,instanceName:I,counter:l.getCounter()}));Ra.find("i").removeClass("fa-play").addClass("fa-pause");ia=!0;e(m).trigger("soundPlay",{instance:m,instanceName:I,counter:l.getCounter()})}).on("pause",function(){Ra.find("i").removeClass("fa-pause").addClass("fa-play");ia=!1;e(m).trigger("soundPause",
{instance:m,instanceName:I,counter:l.getCounter()})}).on("error",function(a){e(m).trigger("soundError",{instance:m,instanceName:I,counter:l.getCounter()})});ha&&(d.load(),d.play());d.volume=w;ha=!0}function Gb(){if(d){var a=d.currentTime,b=d.duration;if(HAPUtils.isNumber(a)&&HAPUtils.isNumber(b)){Hb.html(HAPUtils.formatCurrentTime(a));Ib.html(HAPUtils.formatDuration(b));if("undefined"!==typeof d.buffered&&0!=d.buffered.length){try{var f=d.buffered.end(d.buffered.length-1)}catch(J){}if(!isNaN(f))var c=
f/b}Jb.width(a/b*R);c&&Kb.width(c*R);p.end&&a>=p.end&&Fb()}}ta=requestAnimationFrame(Gb)}function Fb(){e(m).trigger("soundEnd",{instance:m,instanceName:I,counter:l.getCounter()});var a=p.start||0;"next"==Sa?m.nextMedia():"loop"==Sa?(d.currentTime=a,d.play()):"rewind"==Sa?(d.currentTime=a,d.pause()):"stop"==Sa&&d.pause()}function Ta(){ta&&cancelAnimationFrame(ta);d&&(d.pause(),d.src="");Ea&&Ea.off("ended pause play canplay canplaythrough loadedmetadata error");Fa.html(jb);Hb.html("0:00");Ib.html("0:00");
Ua.empty();Lb.html("");Mb.html("");Jb.width(0);Kb.width(0);Ra.find("i").removeClass("fa-pause").addClass("fa-play");E=null;Y=ja=ia=!1;fa=null;ob.find("span").html("0");Wa.find("span").html("0");ua.find("span").html("0")}function ab(){E&&Ta();qa&&(yb&&(x.sortable("destroy"),gb=!1),K.find(".playlist-item").remove());ba=K=null;Da=X=aa=!1;P=-1;hb=!1;r=0;F=-1;v=[];L=[];B=[];l.reSetCounter();Nb.val(kb);Ja=!1;Ob.find("i").removeClass("fa-sort-alpha-asc").addClass("fa-sort-alpha-desc");Fa.html(jb)}function Bb(){R=
Ia.width()}function Pb(){if(Ua.length){var a=new Image;a.className="hidden";a.onload=function(){this.className="visible"};Ua.empty();Ua[0].appendChild(a);a.src=p.thumb}p.title&&Lb.html(p.title);p.artist&&Mb.html(p.artist)}var n=e(this),rb=e(c.playlistList).hide(),jc=n.find(".playlist-holder"),sa=n.find(".playlist-inner"),x=n.find(".playlist-content"),lb=n.find(".playlist-filter-msg"),Ob=n.find(".sort-alpha"),Ka=n.find(".preloader"),Cb=n.find(".popup-toggle");n.find(".player-holder");var Ua=n.find(".player-thumb"),
Lb=n.find(".player-title"),Mb=n.find(".player-artist"),Hb=n.find(".media-time-current"),Ib=n.find(".media-time-total"),Fa=n.find(".media-title"),Ra=n.find(".playback-toggle"),oa=n.find(".loop-toggle"),pa=n.find(".random-toggle"),ua=n.find(".download-count"),ob=n.find(".play-count"),Wa=n.find(".like-count"),qa=jc.length,Z=HAPUtils.isMobile(),Qb=HAPUtils.hasLocalStorage(),Ha=c.sourcePath||"",I=c.instanceName||"",ba=c.activePlaylist,ha=c.autoPlay,N=c.loopingOn,O=c.randomPlay,zb=c.useNumbersInPlaylist,
Ab=c.numberTitleSeparator?c.numberTitleSeparator:".  ",kc=c.artistTitleSeparator?c.artistTitleSeparator:" - ",Oa=c.usePlaylistScroll,Qa=c.playlistScrollOrientation,yb=Z?!1:c.sortableTracks,Rb=c.facebookAppId||"",db=c.soundCloudAppId||"",vb=c.gDriveAppId||"",w=c.volume||.5,lc=c.useKeyboardNavigationForPlayback,Sa=c.mediaEndAction||"next",wb=c.playlistItemContent?c.playlistItemContent.split(","):["title"],Aa=c.useContinousPlayback&&Qb,Ba=c.continousKey,Sb=c.useMediaSession&&"mediaSession"in navigator,
ib=c.useStatistics,ic=c.createDownloadIconsInPlaylist,gc=c.createLinkIconsInPlaylist,m=this,h,Q;e("body");var mb=e(window),U=e(document),nb,hc=HAPUtils.hasDownloadSupport(),mc=HAPUtils.isIOS();HAPUtils.isAndroid();var Ca,ub,Eb,Ea,d,sb,ga,gb,Pa,Ya,R,T,D,aa,Y,X,fb,F=-1,v=[],L=[],B=[],r=0,hb,Da,K,P=-1,ja,E,ia,p,ta,fa,Ja,Na=[],jb=Fa.html();"undefined"===typeof window.hap_mediaArr&&(window.hap_mediaArr=[]);window.hap_mediaArr.push({inst:m,id:I});Z&&(c.autoPlay=!1);N&&oa.find("i").removeClass("icon-color").addClass("icon-rollover-color");
O&&pa.find("i").removeClass("icon-color").addClass("icon-rollover-color");var Nb=n.find(".search-filter").on("focus",function(a){e(this).val()==kb&&e(this).val("")}).on("blur",function(){HAPUtils.isEmpty(e(this).val())&&e(this).val(kb)}).on("keyup.apfilter",function(){if(0==Na.length)return!1;var a=v.length,b=e(this).val(),b=Na.filter(/./.test.bind(new RegExp(b,"i"))),c,d=0,g;for(c=0;c<a;c++)g=m.getTitle(c),-1<e.inArray(g,b)?x.children("div.playlist-item").eq(c).show():(x.children("div.playlist-item").eq(c).hide(),
d++);0<a&&lb.length&&(d==a?lb.show():lb.hide());Oa&&0<r&&"horizontal"==Qa&&sa.mCustomScrollbar("update")}),kb=Nb.val();HAPUtils.isEmpty(Rb)?console.log("facebookAppId has not been set in settings!"):g(Rb);var l=new HAPPlaylistManager({randomPlay:O,loopingOn:N});e(l).on("HAPPlaylistManager.COUNTER_READY",function(){E&&Ta();-1<P&&Za();var a=l.getCounter(),b=x.children("div.playlist-item[data-id="+a+"]"),c=b.find(".playlist-non-selected, .playlist-selected");b.length&&(P=a,c.removeClass("playlist-non-selected").addClass("playlist-selected"),
Oa&&0<r&&(Ya||("horizontal"==Qa?sa.mCustomScrollbar("scrollTo",parseInt(b.position().left),{scrollInertia:500}):sa.mCustomScrollbar("scrollTo",parseInt(b.position().top),{scrollInertia:500})),Ya=!1),e(m).trigger("playlistItemDisabled",{instance:m,instanceName:I,item:b}));a=l.getCounter();p=v[a].data;E=p.type;if("string"===typeof a)var d=a;else"number"===typeof a&&(d=m.getTitle(a),zb&&(d=HAPUtils.formatNumber(a)+Ab+d));Fa.html(d);p.thumb&&Pb();Z&&(ha=!0);Aa&&fa&&(p.resumeTime=fa.resumeTime,Z||(ha=
!0));ib&&G("hap_all_count");Sb&&(navigator.mediaSession.metadata=new MediaMetadata({title:p.title,artist:p.artist||"",album:p.album||"",artwork:p.artwork}));p.download?ua.attr("href",p.download).prop("download",p.download):ua.attr("href","#").removeAttr("download");Db();e(m).trigger("soundRequest",{instance:m,instanceName:I,counter:a})}).on("HAPPlaylistManager.PLAYLIST_END",function(){e(m).trigger("playlistEnd",{instance:m,instanceName:I,counter:l.getCounter()})});Aa&&window.addEventListener(mc?"pagehide":
"beforeunload",function(a){window.event.cancelBubble=!0;if(!h||!E)return!1;a={activePlaylist:ba,volume:w,activeItem:l.getCounter(),resumeTime:m.getCurrentTime()};localStorage.setItem(Ba,JSON.stringify(a))});ib&&(Wa.on("click",function(){if(!h||!E)return!1;G("hap_like_count")}),ua.on("click",function(a){if(!h||!E)return!1;G("hap_download_count")}));Sb&&(navigator.mediaSession.setActionHandler("play",function(){m.playMedia()}),navigator.mediaSession.setActionHandler("pause",function(){m.pauseMedia()}),
navigator.mediaSession.setActionHandler("previoustrack",function(){m.previousMedia()}),navigator.mediaSession.setActionHandler("nexttrack",function(){m.nextMedia()}),navigator.mediaSession.setActionHandler("seekbackward",function(){m.seekBackward()}),navigator.mediaSession.setActionHandler("seekforward",function(){m.seekForward()}));var H=n.find(".tooltip");n.find("[data-tooltip]").on("mouseenter",function(a){var b=e(this),c=n[0].getBoundingClientRect(),d=b[0].getBoundingClientRect();H.find("p").text(b.attr("data-tooltip"));
a=parseInt(d.top-c.top-H.outerHeight());b=parseInt(d.left-c.left-H.outerWidth()/2+b.outerWidth()/2);H.css({left:b+"px",top:a+"px"}).show()}).on("mouseleave",function(a){H.hide()});var Ga,ca,da,va,Ia=n.find(".progress-bg"),Kb=n.find(".load-level"),Jb=n.find(".progress-level");R=Ia.width();"ontouchstart"in window?(Ga="touchstart.ap mousedown.ap",ca="touchmove.ap mousemove.ap",da="touchend.ap mouseup.ap"):window.PointerEvent?(Ga="pointerdown.ap",ca="pointermove.ap",da="pointerup.ap"):(Ga="mousedown.ap",
ca="mousemove.ap",da="mouseup.ap");var ka=n.find(".seekbar").on(Ga,function(a){y(a);return!1});ka.on("mouseover",function(){ja&&(ka.on("mousemove",A).on("mouseout",q),U.on("mouseout",q))});var Xa=.5,xa,pb=n.find(".volume-toggle"),W=n.find(".volume-seekbar"),ma=n.find(".volume-bg"),Vb=n.find(".volume-level"),la=W.hasClass("vertical")?!0:!1,na=la?ma.height():ma.width();0>w?w=0:1<w&&(w=1);0!=w&&(Xa=w);W.on(Ga,function(a){wa(a);return!1});W.on("mouseover",function(){W.on("mousemove",C).on("mouseout",
S);U.on("mouseout",q)});if(lc)U.on("keyup.apnav",function(a){if(!h)return!1;var b=a.keyCode;a=e(a.target);if(37==b)m.previousMedia();else if(39==b)m.nextMedia();else if(32==b){if(a.hasClass("search-filter"))return!1;m.togglePlayback()}else if(77==b){if(a.hasClass("search-filter"))return!1;k()}});var Tb=[n.find(".next-toggle"),n.find(".prev-toggle"),n.find(".playlist-toggle"),n.find(".share-item"),Cb,Ob,Ra,oa,pa],Ub,nc=Tb.length,Va;for(Va=0;Va<nc;Va++)if(Ub=e(Tb[Va]).css("cursor","pointer").on("click",
Wb),!Z)Ub.on("mouseenter",Yb).on("mouseleave",Zb);mb.on("resize",function(){if(!h)return!1;nb&&clearTimeout(nb);nb=setTimeout(Bb,150)});m.getTitle=function(a){a=v[a].data;var b;"undefined"===typeof a.artist||HAPUtils.isEmpty(a.artist)||"undefined"===typeof a.title||HAPUtils.isEmpty(a.title)?"undefined"!==typeof a.artist||"undefined"===typeof a.title||HAPUtils.isEmpty(a.title)?"undefined"===typeof a.artist||HAPUtils.isEmpty(a.artist)||"undefined"!==typeof a.title||(b=a.artist):b=a.title:b=a.artist+
kc+a.title;return b||jb};this.playMedia=function(){if(!h||!E||ia)return!1;d&&d.play()};this.pauseMedia=function(){if(!h||!E||!ia)return!1;d&&d.pause()};this.checkMedia=function(a){if(!h||!E)return!1;a=a.toLowerCase();ia&&"pause"==a&&d&&d.pause()};this.togglePlayback=function(){if(!h||!E)return!1;d&&(d.paused?d.play():d.pause())};this.nextMedia=function(){if(!h||!K)return!1;l.advanceHandler(1,!0)};this.previousMedia=function(){if(!h||!K)return!1;l.advanceHandler(-1,!0)};this.loadMedia=function(a){if(!h||
Q||!K)return!1;if("undefined"===typeof a)return alert("loadMedia method requires either a track number or a track title to load. LoadMedia failed."),!1;if("string"===typeof a){var b,c;for(b=0;b<r;b++)if(a==v[b].data.title){a=b;c=!0;break}if(!c)return alert('Track with title "'+a+'" doesnt exist. LoadMedia failed.'),!1}else if("number"===typeof a){if(0>a||a>r-1)return alert('Invalid track number. Track number  "'+a+'" doesnt exist. LoadMedia failed.'),!1}else return alert("loadMedia method requires either a track number or a track title to load. LoadMedia failed."),
!1;l.processPlaylistRequest(a)};this.loadPlaylist=function(a){if(!h||Q)return!1;if("undefined"===typeof a||HAPUtils.isEmpty(a))return alert("loadPlaylist method requires id parameter. loadPlaylist failed."),!1;if(ba==a)return!1;$a(a)};this.addTrack=function(a,b,c,d){if(!h||Q)return!1;if("undefined"===typeof a)return alert("addTrack method requires format parameter. AddTrack failed."),!1;if("undefined"===typeof b)return alert("addTrack method requires track parameter. AddTrack failed."),!1;Y=!1;"undefined"!==
typeof c&&(Y=c);c=1;var f=!1;if("string"!==typeof b&&"[object Object]"!==Object.prototype.toString.call(b))if("[object Array]"===Object.prototype.toString.call(b))c=b.length,f=!0;else return alert("addTrack method requires track as string, object or array parameter. AddTrack failed."),!1;D=d;T=!1;aa=!0;if(K)if("undefined"!==typeof D){if(0>D||D>r)return alert('Invalid position to insert track to. Position number "'+d+'" doesnt exist. AddTrack failed.'),!1;D==r&&(T=!0)}else T=!0,D=r;else{if("undefined"!==
typeof D){if(0!=D)return alert('Invalid position to insert track to. Position number "'+d+'" doesnt exist. AddTrack failed.'),!1}else D=0;T=!0}Q=!0;Ka.show();Da=!1;fb=!0;F=-1;L=[];B=[];var g;for(d=0;d<c;d++){g=f?b[d]:b;if("html"==a){var k;g=e(g);k=e("<div>").append(g.clone()).html();g=document.createElement("div");g.innerHTML=k;g=e(g.firstChild);g=bb(g)}B.push(g)}r=B.length;X=!1;K||(X=!0);K=x;u()};this.trackDropSort=function(a,b,c,d){if(!h||Q)return!1;D=c;T=!1;D==r&&(T=!0);if(b){Y=!1;"undefined"!==
typeof d&&(Y=d);X=!1;K||(X=!0);K=x;v.length?v.splice(c,0,b):(v.push(b),T=!0);ra();a=item.find(".playlist-non-selected, .playlist-selected").on("click",ea);if(!Z)a.on("mouseenter",M).on("mouseleave",qb);a=l.getCounter();l.setPlaylistItems(r,!1);D<=a&&(T||l.reSetCounter(a+1));X?(X=!1,Y&&!Z&&(ha=!0),l.setCounter(D,!1)):Y&&l.setCounter(D,!1);a=l.getCounter();-1!=a&&(P=a)}else{a=l.getCounter();if(-1!=a){a=x.children("div[data-id='"+a+"']").index();c=[];d=x.children("div");for(b=0;b<r;b++)c.push(parseInt(e(d[b]).attr("data-id"),
10));v=HAPUtils.sortArray(v,c);l.reSetCounter(a);P=a}ra()}};this.inputAudio=function(a){if(!h||Q)return!1;if("undefined"===typeof a)return alert("inputAudio method requires data parameter. inputAudio failed."),!1;Za();l.reSetCounter();p=a;E="audio";p.title&&Fa.html(p.title);p.thumb&&Pb();ha=!0;Db()};this.removeTrack=function(a){if(!h||Q||!K)return!1;if("undefined"===typeof a)return alert("removeTrack method requires id parameter. removeTrack failed."),!1;if("string"===typeof a){var b,c=!1;for(b=0;b<
r;b++)if(a==v[b].data.title){a=b;c=!0;break}if(!c)return alert('Track with title "'+a+'" doesnt exist. RemoveTrack failed.'),!1}else if("number"===typeof a){if(a=parseInt(a,10),0>a||a>r-1)return alert('Invalid id number. Track number  "'+a+'" doesnt exist. RemoveTrack failed.'),!1}else return alert("removeTrack method requires either a id number or a track title to remove. removeTrack failed."),!1;v[a]?(x.children(".playlist-item").eq(a).remove(),v.splice(a,1),ra(),0<r?(b=l.getCounter(),a==b?(Ta(),
l.setPlaylistItems(r)):(l.setPlaylistItems(r,!1),a<b&&l.reSetCounter(l.getCounter()-1)),-1!=l.getCounter()&&(P=l.getCounter())):ab()):alert('RemoveTrack with id "'+a+'" failed.')};this.sort=function(a,b){if(!h||!K)return!1;if("undefined"===typeof a)return console.log("Sort method requires type parameter. Sort method failed."),!1;var c=x.children("div.playlist-item"),d=c.length,g=a.toLowerCase();if(2>d)return!1;if("title"==g)for(HAPUtils.keysrt2(v,"data","title_full",b||!1),d=[],g=0;g<r;g++)d.push(v[g].id);
else if("random"==g)d=HAPUtils.randomiseArray(d),v=HAPUtils.sortArray(v,d);else return console.log("Sort method requires type parameter. Sort method failed."),!1;g=l.getCounter();x.append(e.map(d,function(a){return c[a]}));-1!=g&&(d=x.children("div.playlist-item[data-id='"+g+"']").index(),l.reSetCounter(d),P=d);ra()};this.destroyInstance=function(){mb&&mb.off();W&&W.off();ka&&ka.off()};this.destroyMedia=function(){if(!h)return!1;h&&E&&(qa&&-1<P&&Za(),Ta(),l.reSetCounter())};this.destroyPlaylist=function(){if(!h||
!K)return!1;ab()};this.setPlaybackRate=function(a){if(!h||!E)return!1;d&&(d.playbackRate=Number(a))};this.toggleRandom=function(a){if(!h||"undefined"===typeof l)return!1;O="undefined"!==typeof a?a:!O;l.setRandom(O);O?pa.find("i").removeClass("icon-color").addClass("icon-rollover-color"):pa.find("i").removeClass("icon-rollover-color").addClass("icon-color")};this.toggleLoop=function(a){if(!h||"undefined"===typeof l)return!1;N="undefined"!==typeof a?a:!N;l.setLooping(N);N?oa.find("i").removeClass("icon-color").addClass("icon-rollover-color"):
oa.find("i").removeClass("icon-rollover-color").addClass("icon-color")};this.setVolume=function(a){if(!h)return!1;0>a?a=0:1<a&&(a=1);V(a)};this.getVolume=function(){return h?w:!1};this.toggleMute=function(){if(!h)return!1;k()};this.seek=function(a){if(!h||!E)return!1;try{d.currentTime=a}catch(b){console.log(b)}};this.seekBackward=function(){if(!h||!E)return!1;if(d)try{d.currentTime=Math.max(d.currentTime-10,0)}catch(a){console.log(a)}};this.seekForward=function(){if(!h||!E)return!1;if(d)try{d.currentTime=
Math.min(d.currentTime+10,d.duration)}catch(a){console.log(a)}};this.getCurrentTime=function(){if(!h||!E)return!1;var a=0;d&&(a=d.currentTime);return a};this.getDuration=function(){if(!h||!E)return!1;var a;d&&(a=d.duration);return a};this.destroyPlaylistScroll=function(){if(!h)return!1;sa.mCustomScrollbar("destroy");Pa=!1};this.getWrapper=function(){return h?n:!1};this.getPlaylistList=function(){return h?rb:!1};this.getSetupDone=function(){return h};this.getPlaylistTransition=function(){return Q};
this.getPlaylistLoaded=function(){return Da};this.getMediaPlaying=function(){return h?ia:!1};this.getCounter=function(){return h?"undefined"!==typeof l?l.getCounter():-1:!1};this.getActivePlaylist=function(){return h?ba:!1};this.getPlaylistLength=function(){return h?HAPUtils.isNumber(r)?r:0:!1};this.getPlaylistContent=function(){return h?x:!1};this.getPlaylistData=function(){return v};this.getCurrMediaData=function(){return h?p:!1};this.getSettings=function(){return h?c||null:!1};this.getInstanceName=
function(){return h?I:!1};(function(){if(Aa&&localStorage.getItem(Ba)){var a=JSON.parse(localStorage.getItem(Ba));fa=a;ba=a.activePlaylist;w=a.volume}else Qb&&localStorage.removeItem(Ba);c.isPopup?0==c.playlist_data.length?Ma():(x.append(e(c.current_playlist)),v=c.playlist_data,qa&&xb(),K=x,ra(),l.setPlaylistItems(r),Ma(),Da=!0,e(m).trigger("playlistEndLoad",{instance:m,instanceName:I})):ba&&!HAPUtils.isEmpty(ba)?$a(ba):Ma()})();return this}})(jQuery);
(function(e){var c=function(){};c.isEmpty=function(c){return c?0==c.replace(/^\s+|\s+$/g,"").length:!1};c.isNumber=function(c){return!isNaN(parseFloat(c))&&isFinite(c)};c.isMobile=function(){return/Android|webOS|iPhone|iPad|iPod|sony|BlackBerry/i.test(navigator.userAgent)};c.isIE=function(){var c=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent,y=/MSIE ([0-9]{1,}[.0-9]{0,})/;null!=y.exec(e)&&(c=parseFloat(RegExp.$1))}else"Netscape"==navigator.appName&&(e=navigator.userAgent,
y=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/,null!=y.exec(e)&&(c=parseFloat(RegExp.$1)));return-1!=c?!0:!1};c.isIOS=function(){return navigator.userAgent.match(/(iPad|iPhone|iPod)/g)};c.isAndroid=function(){return-1<navigator.userAgent.indexOf("Android")};c.hasDownloadSupport=function(){return"download"in document.createElement("a")};c.qualifyURL=function(c){var g=document.createElement("a");g.href=c;return g.href};c.hasLocalStorage=function(){try{return"localStorage"in e&&null!==e.localStorage}catch(g){return!1}};
c.randomiseArray=function(c){var g=[],e=[],z,q;for(z=0;z<c;z++)g[z]=z;for(z=0;z<c;z++)q=Math.round(Math.random()*(g.length-1)),e[z]=g[q],g.splice(q,1);return e};c.sortArray=function(c,e){var g,G=c.length,q=[];for(g=0;g<G;g++)q[g]=c[e[g]];return q};c.keysrt=function(c,e,y){var g=1;y&&(g=-1);return c.sort(function(c,G){var q=c[e],k=G[e];return g*(q<k?-1:q>k?1:0)})};c.keysrt2=function(c,e,y,z){var g=1;z&&(g=-1);return c.sort(function(c,G){var k=c[e][y],q=G[e][y];return g*(k<q?-1:k>q?1:0)})};c.parseXML=
function(c){if(e.ActiveXObject&&e.GetObject){var g=new ActiveXObject("Microsoft.XMLDOM");g.loadXML(c);return g}if(e.DOMParser)return(new DOMParser).parseFromString(c,"text/xml");throw Error("No XML parser available");};c.formatCurrentTime=function(c){c=Math.round(c);var g=Math.floor(c/60);c=Math.floor(c%60);return(10<=g?g:""+g)+":"+(10<=c?c:"0"+c)};c.formatDuration=function(c){c=Math.round(c);var e=Math.floor(c/60);c=Math.floor(c%60);return(10<=e?e:""+e)+":"+(10<=c?c:"0"+c)};c.formatNumber=function(c){return 9>
c?"0"+(c+1):c+1};c.nFormatter=function(c,e){var g=[{value:1E18,symbol:"E"},{value:1E15,symbol:"P"},{value:1E12,symbol:"T"},{value:1E9,symbol:"G"},{value:1E6,symbol:"M"},{value:1E3,symbol:"k"}],z=/\.0+$|(\.[0-9]*[1-9])0+$/,q;for(q=0;q<g.length;q++)if(c>=g[q].value)return(c/g[q].value).toFixed(e).replace(z,"$1")+g[q].symbol;return c.toFixed(e).replace(z,"$1")};e.HAPUtils=c})(window);
(function(e,c){e.HAPPlaylistManager=function(e){function g(){3>A||(C=HAPUtils.randomiseArray(A))}var y=this,z=e.loopingOn,q=e.randomPlay,A,wa=!1,k=-1,ya,V,S=!1,C=[],ea=!1;this.setCounter=function(e,G){"undefined"===typeof G&&(G=!0);k=G?k+parseInt(e,10):parseInt(e,10);if(isNaN(k))alert("HAPPlaylistManager message: No active media, counter = "+k);else if(wa=!1,z){if(q)if(k>A-1){k=C[A-1];g();if(C[0]==k){var M=C.splice(0,1);C.push(M)}k=0;c(y).trigger("HAPPlaylistManager.PLAYLIST_END_ALERT")}else 0>k&&
(k=C[0],g(),C[A-1]==k&&(M=C.splice(A-1,1),C.unshift(M)),k=A-1);else k>A-1?(k=0,c(y).trigger("HAPPlaylistManager.PLAYLIST_END_ALERT")):0>k&&(k=A-1);c(y).trigger("HAPPlaylistManager.COUNTER_READY")}else k>A-1?(k=A-1,wa=!0):0>k&&(k=0),wa?c(y).trigger("HAPPlaylistManager.PLAYLIST_END"):c(y).trigger("HAPPlaylistManager.COUNTER_READY")};this.getCounter=function(){return q?ea?k:C[k]:k};this.advanceHandler=function(e){ea=!1;S?(S=!1,V+e>A-1?(k=A-1,c(y).trigger("HAPPlaylistManager.COUNTER_READY")):0>V+e?(k=
0,c(y).trigger("HAPPlaylistManager.COUNTER_READY")):setCounter(V+e,!1)):y.setCounter(e)};this.processPlaylistRequest=function(c){ea=!1;q&&(ea=!0,ya=c,S||(V=k,S=!0));y.setCounter(c,!1)};this.setPlaylistItems=function(c,e){"undefined"===typeof e&&(e=!0);e&&(k=-1);A=c;q&&g()};this.reSetCounter=function(c){"undefined"===typeof c?k=-1:(c=parseInt(c,10),A?(c>A-1?c=A-1:0>c&&(c=0),k=c):k=-1)};this.setRandom=function(c){(q=c)&&g();if(q){var e=C.length;for(c=0;c<e;c++)if(C[c]==k){if(0==c)break;c=C.splice(c,
1);C.unshift(parseInt(c,10));break}k=0}else S?(k=ya,S=!1):k=C[k]};this.setLooping=function(c){z=c};this.getPosition=function(c){return C.indexOf(c)}}})(window,jQuery);